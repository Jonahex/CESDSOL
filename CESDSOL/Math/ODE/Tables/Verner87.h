#pragma once

#include <array>

namespace CESDSOL
{
	struct Verner87
	{
		static constexpr size_t AccuracyOrder = 8;
		static constexpr bool IsExplicit = true;

		static constexpr size_t StepCount = 12;
		static constexpr std::array<double, StepCount> ButcherTableauFirstColumn =
		{
			0.,
			0.05,
			0.1065625,
			0.15984375,
			0.39,
			0.465,
			0.155,
			0.943,
			0.901802041735857,
			0.909,
			0.94,
			1,
		};
		static constexpr std::array<std::array<double, StepCount>, StepCount + 1> ButcherTableauMainPart =
		{ {
			{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0.05, 0, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0}, {-0.0069931640625, 0.1135556640625, 0, 0, 0, 0, 0, 0, 0,
  0, 0, 0}, {0.0399609375, 0, 0.1198828125, 0, 0, 0, 0, 0, 0, 0, 0,
  0}, {0.3613975628004575, 0, -1.341524066700493, 1.370126503900035,
  0, 0, 0, 0, 0, 0, 0, 0}, {0.0490472027972028, 0, 0,
  0.2350972042214405, 0.1808555929813567, 0, 0, 0, 0, 0, 0,
  0}, {0.06169289044289044, 0, 0,
  0.1123656831464028, -0.03885046071451367, 0.01979188712522046, 0, 0,
   0, 0, 0, 0}, {-1.767630240222327, 0, 0, -62.5, -6.061889377376669,
  5.650823198222764, 65.62169641937624, 0, 0, 0, 0,
  0}, {-1.180945066554971, 0,
  0, -41.50473441114321, -4.434438319103725, 4.260408188586133,
  43.75364022446172, 0.00787142548991231, 0, 0, 0,
  0}, {-1.281405999441488, 0,
  0, -45.04713996013987, -4.731362069449576, 4.514967016593808,
  47.44909557172985, 0.01059228297111661, -0.005746842263844617, 0, 0,
   0}, {-1.724470134262485, 0,
  0, -60.92349008483054, -5.951518376222392, 5.556523730698456,
  63.98301198033305, 0.01464202825041496,
  0.06460408772358203, -0.0793032316900888, 0,
  0}, {-3.301622667747079, 0,
  0, -118.0112723597525, -10.14142238845611, 9.139311332232058,
  123.3759428284043, 4.62324437887458, -3.383277738068202,
  4.527592100324618, -5.828495485811623, 0}, {-3.039515033766309, 0,
  0, -109.2608680894176, -9.290642497400293, 8.43050498176491,
  114.2010010378331, -0.9637271342145479, -5.03488408880219,
  5.958130824002923, 0, 0}
		} };

		static constexpr bool IsAdaptive = true;
		static constexpr size_t CorrectionMethodsCount = 1;
		static constexpr std::array<size_t, CorrectionMethodsCount> CorrectionMethodsAccuracyOrders = { 7 };
		static constexpr std::array<std::array<double, StepCount + 1>, CorrectionMethodsCount> ButcherTableauErrorRow =
		{ {
			{-3.272103901028138e-5, 0, 0, 0, 0,
  -0.0005046250618777704,0.0001211723589784759,-20.142336771313868,
				5.2371785994398286,-8.156744408794658,
				22.938283273988784,-0.2361324633071542,0.36016794372897754
			}
		} };

		static constexpr bool IsDenseOutputSupported = true;
		static constexpr size_t DenseOutputStepCount = 8;
		static constexpr std::array<double, DenseOutputStepCount> DenseOutputButcherTableauFirstColumn =
		{
			1,
			0.3110177634953864,
			0.1725,
			0.7846,
			0.37,
			0.5,
			0.7,
			0.9
		};
		static constexpr std::array<std::array<double, StepCount + DenseOutputStepCount + 1>, DenseOutputStepCount> DenseOutputButcherTableauMainPart =
		{ {
			{0.04427989419007951, 0, 0, 0, 0, 0.3541049391724449, \
0.2479692154956438, -15.69420203883808, 25.08406496555856, \
- 31.73836778626028, 22.93828327398878, -0.2361324633071542, 0, 0, 0, \
0, 0, 0, 0, 0}, {0.04620700646754963, 0, 0, 0, 0, \
0.04503904160842481, 0.2336816697713424, 37.83901368421068, \
- 15.94911328945425, 23.0283683518161, -44.85578507769412, \
- 0.06379858768647444, 0, -0.01259503554386166, 0, 0, 0, 0, 0, 0}, \
{0.05037946855482041, 0, 0, 0, 0, 0.0410983613104608, \
0.1718054153348196, 4.614105319981519, -1.791667883085397, \
2.531658930485041, -5.324977860205731, -0.03065532595385635, 0, \
- 0.005254479979429613, -0.08399194644224793, 0, 0, 0, 0, 0}, \
{0.0408289713299708, 0, 0, 0, 0, 0.4244479514247632, \
0.2326091531275235, 2.677982520711806, 0.7420826657338945, \
0.1460377847941461, -3.579344509890565, 0.1138844389600174, 0, \
0.0126779065103319, -0.07443436349946675, 0.04782748079757852, 0, 0, \
0, 0}, {0.05212682393668414, 0, 0, 0, 0, 0.05392508396744798, \
0.01660758097434641, -4.45448575792678, 6.835218278632146, \
- 8.711334822181994, 6.491635839232917, -0.07072551809844346, 0, \
- 0.01854031491993216, 0.02350402105435385, 0.2344795103407822, \
- 0.08241072501152899, 0, 0, 0}, {0.05020102870355714, 0, 0, 0, 0, \
0.1552209034795498, 0.1264268424089235, -5.149206303539847, \
8.46834099903693, -10.6621306810815, 7.541833224959729, \
- 0.07436968113832143, 0, -0.02055887686618383, 0.07753795264710298, \
0.1046259220352544, -0.1179213306451979, 0, 0, 0}, \
{0.03737341446457826, 0, 0, 0, 0, 0.3504930705338317, \
0.4922652819373026, 8.553695439359313, -10.35317299030591, \
13.83320427252915, -12.28092433078462, 0.171915159565651, 0, \
0.03641583114314496, 0.02961920580288763, -0.2651793938627067, \
0.09429503961738067, 0, 0, 0}, {0.03939058345528251, 0, 0, 0, 0, \
0.3558516141234424, 0.419738222595261, 0.8720449778071941, \
0.8989520834876595, -0.6305806161059884, -1.121887220595484, \
0.04298219512400197, 0, 0.01332557566873916, 0.01876227053964148, \
- 0.1859411132922106, 0.1773614271924603, 0, 0, 0}
		} };

		static constexpr size_t InterpolationOrder = 8;
		static constexpr std::array<std::array<double, InterpolationOrder + 1>, StepCount + 1 + DenseOutputStepCount> DenseOutputCoefficients =
		{
		{{0, 1, -10.03915465055452, 53.79210495862331, -165.0579057235472,
  298.026456543461, -311.91254487079,
  174.6059852691172, -40.37066163211959}, {0, 0, 0, 0, 0, 0, 0, 0,
  0}, {0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0,
   0, 0, 0, 0, 0, 0, 0}, {0, 0, 158.1976739121776, -1543.96141721949,
  6241.39874782878, -13136.51615640611,
  15106.9484931696, -8996.489626298231, 2170.776389952444}, {0, 0,
  110.7811520079778, -1081.190514535618,
  4370.666940459977, -9199.113723922197,
  10578.94920962986, -6299.975594978841, 1520.130500554341}, {0,
  0, -7011.442038211314, 68429.55220744078, -276623.5714822198,
  582220.4545548494, -669551.5244611246,
  398731.3087623333, -96210.47174510667}, {0, 0,
  11206.39756984815, -109371.0485495066,
  442127.8393698155, -930563.7629864562,
  1.07014513358559e6, -637292.8058429047, 153773.3309185794}, {0,
  0, -14179.23164045568, 138385.0093196357, -559415.549024087,
  1.177423794699251e6, -1.354033322790821e6,
  806353.893882505, -194566.3328138133}, {0, 0,
  10247.76176792175, -100015.0532637523,
  404306.624014343, -850959.9711689702,
  978601.0462088685, -582776.4729907749, 140619.0037156383}, {0,
  0, -105.4930397685097, 1029.58013958031, -4162.034181876453,
  8759.996193602336, -10073.96555688605,
  5999.247741473951, -1447.567428588892}, {0, 0, 0, 0, 0, 0, 0, 0,
  0}, {0, 0, -14.86361337326743,
  145.7635936489487, -587.6557063401914,
  1227.372151254556, -1394.493105740554,
  816.8562950730669, -192.9796145225588}, {0, 0,
  14.34968575290546, -150.2949344481666,
  629.481242570029, -1352.518207309061,
  1575.89693370888, -946.7876580472948, 229.8729377727072}, {0,
  0, -102.545247011104, 1074.032661264681, -4498.377917100411,
  9665.320624003281, -11261.62224831288,
  6765.902468760784, -1642.71034160435}, {0, 0, -38.13206313286474,
  399.3854658292329, -1672.748720491972,
  3594.107254858567, -4187.701556802927,
  2515.941280649064, -610.8516609091005}, {0, 0, -66.38279583069588,
  595.8297683881103, -2188.737060092972,
  4213.839795282853, -4484.035731929197,
  2500.648251425347, -571.1622272434449}, {0, 0, -90.4188757317306,
  931.9503884048154, -3962.898377713156,
  8733.31742002555, -10445.90818988766,
  6426.218942917599, -1592.261308015418}, {0, 0, -59.73884363038872,
  544.8870146891725, -2090.430374926313,
  4194.418982707227, -4603.369436819628,
  2619.201413559298, -604.9687555793671}, {0, 0, -59.20053764683937,
  571.7660156218088, -2308.949564445361,
  4881.23411068614, -5660.118807771202,
  3408.706689037422, -833.4379054819676}}
		};
	};
}